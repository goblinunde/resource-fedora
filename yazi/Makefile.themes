.PHONY: theme-list theme-apply theme-tokyo theme-storm theme-catppuccin theme-gruvbox theme-nord

# ============================================================================
# Yazi ä¸»é¢˜ç®¡ç† Makefile
# ç”¨é€”: å¿«é€Ÿåˆ‡æ¢å’Œç®¡ç† Yazi ä¸»é¢˜
# ============================================================================

YAZI_CONFIG := $(HOME)/.config/yazi
THEMES_DIR := $(PWD)/themes
CURRENT_THEME_FILE := $(YAZI_CONFIG)/theme.toml

# é¢œè‰²å®šä¹‰
COLOR_RESET := \033[0m
COLOR_GREEN := \033[0;32m
COLOR_CYAN := \033[0;36m
COLOR_YELLOW := \033[1;33m

# ============================================================================
# ä¸»é¢˜å‘½ä»¤
# ============================================================================

theme-list:  ## åˆ—å‡ºæ‰€æœ‰å¯ç”¨ä¸»é¢˜
	@echo ""
	@echo "$(COLOR_CYAN)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@echo "$(COLOR_CYAN)          Yazi å¯ç”¨ä¸»é¢˜åˆ—è¡¨$(COLOR_RESET)"
	@echo "$(COLOR_CYAN)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@echo ""
	@echo "  1. $(COLOR_GREEN)Tokyo Night$(COLOR_RESET)        - é»˜è®¤ Tokyo Night ä¸»é¢˜"
	@echo "  2. $(COLOR_GREEN)Tokyo Night Storm$(COLOR_RESET) - æ›´æ·±èƒŒæ™¯çš„ Tokyo Night"
	@echo "  3. $(COLOR_GREEN)Catppuccin Mocha$(COLOR_RESET)  - æ¸©æš–æŸ”å’Œçš„æ·±è‰²ä¸»é¢˜"
	@echo "  4. $(COLOR_GREEN)Gruvbox Dark$(COLOR_RESET)      - å¤å¤æ€€æ—§é…è‰²"
	@echo "  5. $(COLOR_GREEN)Nord$(COLOR_RESET)              - æåœ°å†·è‰²è°ƒä¸»é¢˜"
	@echo ""
	@echo "$(COLOR_YELLOW)ä½¿ç”¨æ–¹æ³•:$(COLOR_RESET)"
	@echo "  make theme-tokyo        # åº”ç”¨ Tokyo Night ä¸»é¢˜"
	@echo "  make theme-storm        # åº”ç”¨ Tokyo Night Storm ä¸»é¢˜"
	@echo "  make theme-catppuccin   # åº”ç”¨ Catppuccin Mocha ä¸»é¢˜"
	@echo "  make theme-gruvbox      # åº”ç”¨ Gruvbox Dark ä¸»é¢˜"
	@echo "  make theme-nord         # åº”ç”¨ Nord ä¸»é¢˜"
	@echo ""

theme-tokyo:  ## åº”ç”¨ Tokyo Night ä¸»é¢˜
	@echo "$(COLOR_CYAN)ğŸ¨ åº”ç”¨ Tokyo Night ä¸»é¢˜...$(COLOR_RESET)"
	@cp "$(PWD)/theme.toml" "$(CURRENT_THEME_FILE)"
	@echo "$(COLOR_GREEN)âœ” Tokyo Night ä¸»é¢˜å·²åº”ç”¨$(COLOR_RESET)"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-storm:  ## åº”ç”¨ Tokyo Night Storm ä¸»é¢˜
	@echo "$(COLOR_CYAN)ğŸ¨ åº”ç”¨ Tokyo Night Storm ä¸»é¢˜...$(COLOR_RESET)"
	@cp "$(THEMES_DIR)/tokyo-night-storm.toml" "$(CURRENT_THEME_FILE)"
	@echo "$(COLOR_GREEN)âœ” Tokyo Night Storm ä¸»é¢˜å·²åº”ç”¨$(COLOR_RESET)"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-catppuccin:  ## åº”ç”¨ Catppuccin Mocha ä¸»é¢˜
	@echo "$(COLOR_CYAN)ğŸ¨ åº”ç”¨ Catppuccin Mocha ä¸»é¢˜...$(COLOR_RESET)"
	@cp "$(THEMES_DIR)/catppuccin-mocha.toml" "$(CURRENT_THEME_FILE)"
	@echo "$(COLOR_GREEN)âœ” Catppuccin Mocha ä¸»é¢˜å·²åº”ç”¨$(COLOR_RESET)"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-gruvbox:  ## åº”ç”¨ Gruvbox Dark ä¸»é¢˜
	@echo "$(COLOR_CYAN)ğŸ¨ åº”ç”¨ Gruvbox Dark ä¸»é¢˜...$(COLOR_RESET)"
	@cp "$(THEMES_DIR)/gruvbox-dark.toml" "$(CURRENT_THEME_FILE)"
	@echo "$(COLOR_GREEN)âœ” Gruvbox Dark ä¸»é¢˜å·²åº”ç”¨$(COLOR_RESET)"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-nord:  ## åº”ç”¨ Nord ä¸»é¢˜
	@echo "$(COLOR_CYAN)ğŸ¨ åº”ç”¨ Nord ä¸»é¢˜...$(COLOR_RESET)"
	@cp "$(THEMES_DIR)/nord.toml" "$(CURRENT_THEME_FILE)"
	@echo "$(COLOR_GREEN)âœ” Nord ä¸»é¢˜å·²åº”ç”¨$(COLOR_RESET)"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-current:  ## æ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„ä¸»é¢˜
	@echo "$(COLOR_CYAN)å½“å‰ä¸»é¢˜:$(COLOR_RESET)"
	@grep 'use = ' "$(CURRENT_THEME_FILE)" 2>/dev/null || echo "  æœªæ‰¾åˆ°ä¸»é¢˜é…ç½®"

theme-backup:  ## å¤‡ä»½å½“å‰ä¸»é¢˜
	@echo "$(COLOR_CYAN)ğŸ’¾ å¤‡ä»½å½“å‰ä¸»é¢˜...$(COLOR_RESET)"
	@cp "$(CURRENT_THEME_FILE)" "$(CURRENT_THEME_FILE).backup-$(shell date +%Y%m%d-%H%M%S)"
	@echo "$(COLOR_GREEN)âœ” ä¸»é¢˜å·²å¤‡ä»½$(COLOR_RESET)"

theme-restore:  ## æ¢å¤å¤‡ä»½çš„ä¸»é¢˜
	@echo "$(COLOR_YELLOW)å¯ç”¨å¤‡ä»½:$(COLOR_RESET)"
	@ls -1 "$(YAZI_CONFIG)"/theme.toml.backup-* 2>/dev/null || echo "  æ— å¯ç”¨å¤‡ä»½"

help:  ## æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | \
		awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-20s\033[0m %s\n", $$1, $$2}'
