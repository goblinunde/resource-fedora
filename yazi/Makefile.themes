.PHONY: theme-list theme-apply theme-tokyo theme-storm theme-catppuccin theme-gruvbox theme-nord

# ============================================================================
# Yazi ä¸»é¢˜ç®¡ç† Makefile
# ç”¨é€”: å¿«é€Ÿåˆ‡æ¢å’Œç®¡ç† Yazi ä¸»é¢˜
# ============================================================================

YAZI_CONFIG := $(HOME)/.config/yazi
THEMES_DIR := $(PWD)/themes
CURRENT_THEME_FILE := $(YAZI_CONFIG)/theme.toml

# é¢œè‰²å®šä¹‰
COLOR_RESET := \033[0m
COLOR_GREEN := \033[0;32m
COLOR_CYAN := \033[0;36m
COLOR_YELLOW := \033[1;33m

# ============================================================================
# ä¸»é¢˜å‘½ä»¤
# ============================================================================

theme-list:  ## åˆ—å‡ºæ‰€æœ‰å¯ç”¨ä¸»é¢˜
	@echo ""
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo "          Yazi å¯ç”¨ä¸»é¢˜åˆ—è¡¨"
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo ""
	@echo "  1. Tokyo Night        - é»˜è®¤ Tokyo Night ä¸»é¢˜"
	@echo "  2. Tokyo Night Storm - æ›´æ·±èƒŒæ™¯çš„ Tokyo Night"
	@echo "  3. Catppuccin Mocha  - æ¸©æš–æŸ”å’Œçš„æ·±è‰²ä¸»é¢˜"
	@echo "  4. Gruvbox Dark      - å¤å¤æ€€æ—§é…è‰²"
	@echo "  5. Nord              - æåœ°å†·è‰²è°ƒä¸»é¢˜"
	@echo ""
	@echo "ä½¿ç”¨æ–¹æ³•:"
	@echo ""
	@echo "  ã€æ¨èã€‘åœ¨é¡¹ç›®ä¸»ç›®å½•æ‰§è¡Œ (éœ€è¦ yazi- å‰ç¼€):"
	@echo "    make yazi-theme-tokyo        # åº”ç”¨ Tokyo Night"
	@echo "    make yazi-theme-storm        # åº”ç”¨ Tokyo Night Storm"
	@echo "    make yazi-theme-catppuccin   # åº”ç”¨ Catppuccin Mocha"
	@echo "    make yazi-theme-gruvbox      # åº”ç”¨ Gruvbox Dark"
	@echo "    make yazi-theme-nord         # åº”ç”¨ Nord"
	@echo ""
	@echo "  ã€å¤‡é€‰ã€‘åœ¨ yazi/ å­ç›®å½•æ‰§è¡Œ (æ— éœ€ yazi- å‰ç¼€):"
	@echo "    cd yazi && make -f Makefile.themes theme-tokyo"
	@echo "    cd yazi && make -f Makefile.themes theme-storm"
	@echo "    ..."
	@echo ""
	@echo "  ğŸ’¡ æç¤º: ä¸»ç›®å½•çš„ make yazi-theme-* å‘½ä»¤ä¼šè‡ªåŠ¨è°ƒç”¨ yazi/Makefile.themes"
	@echo ""

theme-tokyo:  ## åº”ç”¨ Tokyo Night ä¸»é¢˜
	@echo "ğŸ¨ åº”ç”¨ Tokyo Night ä¸»é¢˜..."
	@cp "$(PWD)/theme.toml" "$(CURRENT_THEME_FILE)"
	@echo "âœ” Tokyo Night ä¸»é¢˜å·²åº”ç”¨"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-storm:  ## åº”ç”¨ Tokyo Night Storm ä¸»é¢˜
	@echo "ğŸ¨ åº”ç”¨ Tokyo Night Storm ä¸»é¢˜..."
	@cp "$(THEMES_DIR)/tokyo-night-storm.toml" "$(CURRENT_THEME_FILE)"
	@echo "âœ” Tokyo Night Storm ä¸»é¢˜å·²åº”ç”¨"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-catppuccin:  ## åº”ç”¨ Catppuccin Mocha ä¸»é¢˜
	@echo "ğŸ¨ åº”ç”¨ Catppuccin Mocha ä¸»é¢˜..."
	@cp "$(THEMES_DIR)/catppuccin-mocha.toml" "$(CURRENT_THEME_FILE)"
	@echo "âœ” Catppuccin Mocha ä¸»é¢˜å·²åº”ç”¨"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-gruvbox:  ## åº”ç”¨ Gruvbox Dark ä¸»é¢˜
	@echo "ğŸ¨ åº”ç”¨ Gruvbox Dark ä¸»é¢˜..."
	@cp "$(THEMES_DIR)/gruvbox-dark.toml" "$(CURRENT_THEME_FILE)"
	@echo "âœ” Gruvbox Dark ä¸»é¢˜å·²åº”ç”¨"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-nord:  ## åº”ç”¨ Nord ä¸»é¢˜
	@echo "ğŸ¨ åº”ç”¨ Nord ä¸»é¢˜..."
	@cp "$(THEMES_DIR)/nord.toml" "$(CURRENT_THEME_FILE)"
	@echo "âœ” Nord ä¸»é¢˜å·²åº”ç”¨"
	@echo "  è¯·é‡å¯ Yazi æˆ–æŒ‰ R åˆ·æ–°ä»¥æŸ¥çœ‹æ•ˆæœ"

theme-current:  ## æ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„ä¸»é¢˜
	@echo "å½“å‰ä¸»é¢˜:"
	@grep 'use = ' "$(CURRENT_THEME_FILE)" 2>/dev/null || echo "  æœªæ‰¾åˆ°ä¸»é¢˜é…ç½®"

theme-backup:  ## å¤‡ä»½å½“å‰ä¸»é¢˜
	@echo "ğŸ’¾ å¤‡ä»½å½“å‰ä¸»é¢˜..."
	@cp "$(CURRENT_THEME_FILE)" "$(CURRENT_THEME_FILE).backup-$(shell date +%Y%m%d-%H%M%S)"
	@echo "âœ” ä¸»é¢˜å·²å¤‡ä»½"

theme-restore:  ## æ¢å¤å¤‡ä»½çš„ä¸»é¢˜
	@echo "å¯ç”¨å¤‡ä»½:"
	@ls -1 "$(YAZI_CONFIG)"/theme.toml.backup-* 2>/dev/null || echo "  æ— å¯ç”¨å¤‡ä»½"

help:  ## æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | \
		awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-20s\033[0m %s\n", $$1, $$2}'
